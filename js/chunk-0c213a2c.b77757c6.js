(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0c213a2c"],{"10be":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("AdminDishForm",{attrs:{"is-processing":t.isProcessing},on:{"after-submit":t.handleAfterSubmit}})],1)},r=[],i=(a("d3b7"),a("96cf"),a("e066")),n=a("ff4b"),o={components:{AdminDishForm:i["a"]},data:function(){return{isProcessing:!1}},computed:{},created:function(){},methods:{handleAfterSubmit:function(t){var e,a,s;return regeneratorRuntime.async((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,this.isProcessing=!0,r.next=4,regeneratorRuntime.awrap(n["a"].dish.post(t));case 4:if(e=r.sent,a=e.data,s=e.statusText,"OK"===s&&"success"===a.status){r.next=9;break}throw new Error(s);case 9:this.$router.push({name:"manage-dishes",query:{categoryId:t.CategoryId}}),this.$swal({toast:!0,position:"top",showConfirmButton:!1,timer:3e3,type:"success",title:"成功建立菜單",text:""}),r.next=18;break;case 13:r.prev=13,r.t0=r["catch"](0),this.isProcessing=!1,this.$swal({toast:!0,position:"top",showConfirmButton:!1,timer:3e3,type:"warning",title:"建立菜單失敗，請稍後再試",text:""}),console.log("error",r.t0);case 18:case"end":return r.stop()}}),null,this,[[0,13]])}}},c=o,u=a("2877"),d=Object(u["a"])(c,s,r,!1,null,null,null);e["default"]=d.exports},"9b2a":function(t,e,a){"use strict";a("d3b7"),a("25f0"),a("3ca3"),a("ddb0"),a("2b3d");var s=a("2fa3");e["a"]={categories:{get:function(){return s["a"].get("/categories")}},dishes:{get:function(t){var e=t.categoryId,a=new URLSearchParams({categoryId:e});return s["a"].get("/dishes?".concat(a.toString()))}},user:{get:function(t){var e=t.phone,a=new URLSearchParams({phone:e});return s["a"].get("/searchUser?".concat(a.toString()))}},list:{post:function(t){var e=t.dishes,a=t.UserId,r=t.tableNum,i=t.isTakingAway,n=t.memo,o=t.quantity,c=t.amount;return s["a"].post("/orders",{dishes:e,UserId:a,tableNum:r,isTakingAway:i,memo:n,quantity:o,amount:c})}}}},e066:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{},[a("h1",{staticClass:"text-center my-2"},[t._v("新增菜單")]),a("form",{directives:[{name:"show",rawName:"v-show",value:!t.isLoading,expression:"!isLoading"}],staticClass:"row",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSubmit(e)}}},[a("div",{staticClass:"form-group col-6"},[a("label",{attrs:{for:"name"}},[t._v("餐點名稱")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.dish.name,expression:"dish.name"}],staticClass:"form-control",attrs:{id:"name",type:"text",name:"name",placeholder:"Enter name",required:""},domProps:{value:t.dish.name},on:{input:function(e){e.target.composing||t.$set(t.dish,"name",e.target.value)}}})]),a("div",{staticClass:"form-group col-6"},[a("label",{attrs:{for:"categoryId"}},[t._v("類型")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.dish.CategoryId,expression:"dish.CategoryId"}],staticClass:"form-control",attrs:{id:"categoryId",name:"categoryId",required:""},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.dish,"CategoryId",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"",selected:"",disabled:""}},[t._v("--請選擇--")]),t._l(t.categories,(function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])}))],2)]),t._l(t.allTags,(function(e){return a("div",{key:e.id,staticClass:"form-check form-check-inline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.dish.tags,expression:"dish.tags"}],staticClass:"form-check-input",attrs:{type:"checkbox",id:e.id},domProps:{value:e.id,checked:Array.isArray(t.dish.tags)?t._i(t.dish.tags,e.id)>-1:t.dish.tags},on:{change:function(a){var s=t.dish.tags,r=a.target,i=!!r.checked;if(Array.isArray(s)){var n=e.id,o=t._i(s,n);r.checked?o<0&&t.$set(t.dish,"tags",s.concat([n])):o>-1&&t.$set(t.dish,"tags",s.slice(0,o).concat(s.slice(o+1)))}else t.$set(t.dish,"tags",i)}}}),a("label",{staticClass:"form-check-label",attrs:{for:e.id}},[t._v(t._s(e.name))])])})),a("div",{staticClass:"form-group col-6"},[a("label",{attrs:{for:"price"}},[t._v("價格")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.dish.price,expression:"dish.price"}],staticClass:"form-control",attrs:{id:"price",type:"number",name:"price"},domProps:{value:t.dish.price},on:{input:function(e){e.target.composing||t.$set(t.dish,"price",e.target.value)}}})]),a("div",{staticClass:"form-group col-6"},[a("label",{attrs:{for:"description"}},[t._v("說明")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.dish.description,expression:"dish.description"}],staticClass:"form-control",attrs:{id:"description",rows:"3",name:"description"},domProps:{value:t.dish.description},on:{input:function(e){e.target.composing||t.$set(t.dish,"description",e.target.value)}}})]),a("div",{staticClass:"form-group col-6"},[a("label",{attrs:{for:"image"}},[t._v("相片")]),t.dish.image?a("img",{staticClass:"d-block img-thumbnail mb-3",attrs:{src:t.dish.image,width:"200",height:"200"}}):t._e(),a("input",{staticClass:"form-control-file",attrs:{id:"image",type:"file",name:"image",accept:"image/*"},on:{change:t.handleFileChange}})]),a("button",{staticClass:"btn btn-primary col-6",attrs:{type:"submit",disabled:t.isProcessing}},[t._v(t._s(this.isProcessing?"處理中...":"送出"))])],2)])},r=[],i=(a("b0c0"),a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("96cf"),a("9b2a")),n=a("ff4b"),o={props:{initialDish:{type:Object,default:function(){return{name:"",CategoryId:"",price:"",tags:[],description:"",image:""}}},isProcessing:{type:Boolean,default:!1}},data:function(){return{dish:{name:"",CategoryId:"",price:"",tags:[],description:"",image:""},categories:[],allTags:[],isLoading:!0}},computed:{},created:function(){this.fetchCategories(),this.fetchTags()},methods:{fetchCategories:function(){var t,e,a;return regeneratorRuntime.async((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,regeneratorRuntime.awrap(i["a"].categories.get());case 3:if(t=s.sent,e=t.data,a=t.statusText,"OK"===a){s.next=7;break}throw new Error(a);case 7:this.categories=e,this.isLoading=!1,s.next=14;break;case 11:s.prev=11,s.t0=s["catch"](0),console.log("error",s.t0);case 14:case"end":return s.stop()}}),null,this,[[0,11]])},fetchTags:function(){var t,e,a;return regeneratorRuntime.async((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,regeneratorRuntime.awrap(n["a"].tag.get());case 3:if(t=s.sent,e=t.data,a=t.statusText,"OK"===a){s.next=7;break}throw new Error(a);case 7:this.allTags=e,s.next=13;break;case 10:s.prev=10,s.t0=s["catch"](0),console.log("error",s.t0);case 13:case"end":return s.stop()}}),null,this,[[0,10]])},handleFileChange:function(t){var e=t.target.files;if(e.length){var a=window.URL.createObjectURL(e[0]);this.dish.image=a}},handleSubmit:function(){this.dish.name?this.dish.CategoryId?this.$emit("after-submit",this.dish):this.$swal({toast:!0,position:"top",showConfirmButton:!1,timer:3e3,type:"warning",title:"請選擇餐點類別",text:""}):this.$swal({toast:!0,position:"top",showConfirmButton:!1,timer:3e3,type:"warning",title:"請填寫餐點名稱",text:""})}}},c=o,u=a("2877"),d=Object(u["a"])(c,s,r,!1,null,null,null);e["a"]=d.exports},ff4b:function(t,e,a){"use strict";a("b0c0"),a("d3b7"),a("25f0"),a("3ca3"),a("ddb0"),a("2b3d");var s=a("2fa3"),r=function(){return localStorage.getItem("token")};e["a"]={dish:{get:function(t){var e=new URLSearchParams(t);return s["a"].get("/dishes?".concat(e.toString()))},post:function(t){return s["a"].post("/dishes",t)},put:function(t){var e=t.dishId,a=t.formData;return s["a"].put("/dishes/".concat(e),a)},delete:function(t){return s["a"].delete("/dishes/".concat(t))}},category:{get:function(){return s["a"].get("/categories",{headers:{Authorization:"Bearer ".concat(r())}})},post:function(t){return s["a"].post("/categories",t)},put:function(t){var e=t.categoryId,a=t.name;return s["a"].put("/categories/".concat(e),{name:a})},delete:function(t){return s["a"].delete("/categories/".concat(t))}},tag:{get:function(){return s["a"].get("/tags",{headers:{Authorization:"Bearer ".concat(r())}})},post:function(t){return s["a"].post("/tags",t)},put:function(t){var e=t.categoryId,a=t.name;return s["a"].put("/tags/".concat(e),{name:a})},delete:function(t){return s["a"].delete("/tags/".concat(t))}}}}}]);
//# sourceMappingURL=chunk-0c213a2c.b77757c6.js.map